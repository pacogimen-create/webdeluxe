---
import { supabase } from '../lib/supabase';

// Fetch active coaches
const { data: coachesData, error } = await supabase
  .from('coaches')
  .select('*')
  .eq('active', true)
  .order('display_order', { ascending: true });

const coaches = coachesData || [];
---

<section id="equipo" class="section">
  <div class="container">
    <div class="section-header text-center fade-in-up">
      <span class="section-badge">Nuestro Equipo</span>
      <h2 class="section-title">Conoce a Nuestros Entrenadores</h2>
      <p class="section-subtitle">
        Profesionales certificados comprometidos con tu desarrollo deportivo
      </p>
    </div>

    <div class="grid grid-3 stagger-container">
      {coaches.length > 0 ? (
        coaches.map((coach) => (
          <div class="coach-card card card-animated stagger-item">
            <div class="coach-image-wrapper">
              <img 
                src={coach.image_url || `https://ui-avatars.com/api/?name=${encodeURIComponent(coach.name)}&size=400&background=0066cc&color=fff&bold=true`}
                alt={coach.name}
                class="coach-image"
                loading="lazy"
              />
              <div class="coach-overlay">
                <div class="coach-specialties">
                  {coach.specialties?.map((specialty: string) => (
                    <span class="specialty-tag">{specialty}</span>
                  ))}
                </div>
              </div>
            </div>
            <div class="coach-content">
              <h3 class="coach-name">{coach.name}</h3>
              <p class="coach-role">{coach.role}</p>
              {coach.bio && (
                <p class="coach-bio">{coach.bio}</p>
              )}
            </div>
          </div>
        ))
      ) : (
        <>
          <div class="coach-card card card-animated stagger-item">
            <div class="coach-image-wrapper">
              <img 
                src="https://images.unsplash.com/photo-1568602471122-7832951cc4c5?w=400&h=400&fit=crop"
                alt="Entrenador"
                class="coach-image"
              />
            </div>
            <div class="coach-content">
              <h3 class="coach-name">Carlos Martínez</h3>
              <p class="coach-role">Director Técnico</p>
              <p class="coach-bio">Más de 15 años de experiencia en natación competitiva.</p>
            </div>
          </div>
          
          <div class="coach-card card card-animated stagger-item">
            <div class="coach-image-wrapper">
              <img 
                src="https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?w=400&h=400&fit=crop"
                alt="Entrenadora"
                class="coach-image"
              />
            </div>
            <div class="coach-content">
              <h3 class="coach-name">Ana García</h3>
              <p class="coach-role">Entrenadora Principal</p>
              <p class="coach-bio">Especialista en desarrollo de jóvenes nadadores.</p>
            </div>
          </div>
          
          <div class="coach-card card card-animated stagger-item">
            <div class="coach-image-wrapper">
              <img 
                src="https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=400&h=400&fit=crop"
                alt="Entrenador"
                class="coach-image"
              />
            </div>
            <div class="coach-content">
              <h3 class="coach-name">Miguel Sánchez</h3>
              <p class="coach-role">Entrenador Asistente</p>
              <p class="coach-bio">Enfocado en técnica de estilo libre y mariposa.</p>
            </div>
          </div>
        </>
      )}
    </div>
  </div>
</section>

<style>
  .coach-card {
    text-align: center;
    padding: 0;
    overflow: hidden;
  }

  .coach-image-wrapper {
    position: relative;
    width: 100%;
    aspect-ratio: 1;
    overflow: hidden;
  }

  .coach-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--transition-slow);
  }

  .coach-card:hover .coach-image {
    transform: scale(1.1);
  }

  .coach-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(to top, rgba(0, 0, 0, 0.8) 0%, transparent 50%);
    display: flex;
    align-items: flex-end;
    padding: var(--space-md);
    opacity: 0;
    transition: opacity var(--transition-base);
  }

  .coach-card:hover .coach-overlay {
    opacity: 1;
  }

  .coach-specialties {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-xs);
  }

  .specialty-tag {
    padding: 0.25rem 0.75rem;
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    color: var(--color-white);
    border-radius: var(--radius-full);
    font-size: var(--text-xs);
    font-weight: 600;
  }

  .coach-content {
    padding: var(--space-lg);
  }

  .coach-name {
    font-size: var(--text-xl);
    font-weight: 700;
    color: var(--color-dark);
    margin-bottom: var(--space-xs);
  }

  .coach-role {
    font-size: var(--text-base);
    color: var(--color-primary);
    font-weight: 600;
    margin-bottom: var(--space-sm);
  }

  .coach-bio {
    font-size: var(--text-sm);
    color: var(--color-gray);
    line-height: 1.6;
  }
</style>
